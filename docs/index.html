<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fan Club MkIV - 智能风扇控制系统</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.min.css" rel="stylesheet">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-container">
                <h1 class="nav-title">Fan Club MkIV</h1>
                <ul class="nav-menu">
                    <li><a href="#overview">项目概述</a></li>
                    <li><a href="#features">功能特性</a></li>
                    <li><a href="#architecture">系统架构</a></li>
                    <li><a href="#setup">快速开始</a></li>
                    <li><a href="#api">API文档</a></li>
                    <li><a href="#download">下载</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main>
        <!-- Hero Section -->
        <section class="hero">
            <div class="hero-content">
                <h1>Fan Club MkIV</h1>
                <p class="hero-subtitle">基于STM32的智能风扇控制系统</p>
                <div class="hero-buttons">
                    <a href="#setup" class="btn btn-primary">快速开始</a>
                    <a href="https://github.com/your-username/fan-club-master" class="btn btn-secondary">GitHub</a>
                </div>
            </div>
        </section>

        <!-- Overview Section -->
        <section id="overview" class="section">
            <div class="container">
                <h2>项目概述</h2>
                <div class="overview-grid">
                    <div class="overview-card">
                        <h3>🎯 项目概述</h3>
                        <ul>
                            <li>分布式风扇控制系统</li>
                            <li>支持多达21个风扇同时控制</li>
                            <li>基于NUCLEO F429ZI开发板</li>
                            <li>实时以太网通信协议</li>
                            <li>Python Tkinter GUI控制界面</li>
                            <li>加州理工学院GALCIT实验室开发</li>
                        </ul>
                    </div>
                    <div class="overview-card">
                        <h3>🔧 核心技术</h3>
                        <ul>
                            <li>Mbed OS 5.x嵌入式操作系统</li>
                            <li>UDP多播网络通信</li>
                            <li>多线程并发处理架构</li>
                            <li>高精度PWM风扇控制</li>
                            <li>实时RPM转速监测</li>
                            <li>硬件抽象层(HAL)设计</li>
                        </ul>
                    </div>
                    <div class="overview-card">
                        <h3>🎮 应用场景</h3>
                        <ul>
                            <li>航空航天实验室环境控制</li>
                            <li>风洞实验气流调节</li>
                            <li>精密仪器散热管理</li>
                            <li>自主系统技术研究</li>
                            <li>分布式控制系统教学</li>
                            <li>工业自动化原型开发</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section id="features" class="section bg-light">
            <div class="container">
                <h2>功能特性</h2>
                <div class="features-grid">
                    <div class="feature-item">
                        <div class="feature-icon">⚡</div>
                        <h3>高精度PWM控制</h3>
                        <p>支持0-100%无级调速，响应时间小于10ms</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">🌐</div>
                        <h3>分布式网络架构</h3>
                        <p>基于UDP协议的以太网通信，支持广播发现(端口65000)和双向数据传输(MISO/MOSI)。自动MAC地址识别，支持多达21个从设备同时连接。</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">⚡</div>
                        <h3>高精度实时控制</h3>
                        <p>500ms超时检测，30ms风扇响应时间，支持PWM占空比精确调节。实时RPM转速监测，具备硬件中断和软件超时双重保护机制。</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">🎛️</div>
                        <h3>多配置文件管理</h3>
                        <p>支持SEVENSQ、MODULE、DEV、BOX等多种预设配置。动态配置切换，支持不同实验场景的快速部署和设备重新分配。</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">🔒</div>
                        <h3>企业级安全机制</h3>
                        <p>通信密码验证(PASSCODE "CT")，设备身份认证，网络超时保护。支持最多10次网络超时和主控超时检测，确保系统稳定运行。</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">📊</div>
                        <h3>实时数据监控</h3>
                        <p>Python多进程架构，实时数据采集和状态监控。支持LED状态指示(红/绿灯)，串口调试输出(460800波特率)，便于系统诊断。</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">🔧</div>
                        <h3>模块化硬件支持</h3>
                        <p>支持NUCLEO F429ZI/F439ZI开发板，兼容JPL和标准硬件配置。模块化Fan类设计，支持不同版本的引脚定义和硬件适配。</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Architecture Section -->
        <section id="architecture" class="section">
            <div class="container">
                <h2>系统架构</h2>
                <div class="architecture-content">
                    <div class="arch-diagram">
                        <img src="architecture-diagram.svg" alt="系统架构图" class="responsive-img">
                    </div>
                    <div class="arch-description">
                        <h3>分层架构设计</h3>
                        <div class="arch-layer">
                            <h4>🖥️ 主控层 (Master Layer)</h4>
                            <p>Python 3主控程序，基于Tkinter的GUI界面，提供网络管理、配置文件切换、实时监控和数据可视化功能。支持多种预设配置文件(SEVENSQ、MODULE、DEV等)。</p>
                        </div>
                        <div class="arch-layer">
                            <h4>🌐 通信层 (Communication Layer)</h4>
                            <p>基于UDP协议的以太网通信，使用端口65000进行广播发现，60000/60001进行MISO/MOSI双向通信。支持MAC地址识别和自动设备发现。</p>
                        </div>
                        <div class="arch-layer">
                            <h4>⚡ 从控层 (Slave Layer)</h4>
                            <p>NUCLEO F429ZI微控制器，运行Mbed OS，实现多线程并发处理：监听线程、MISO/MOSI通信线程。支持最多21个风扇的独立控制。</p>
                        </div>
                        <div class="arch-layer">
                            <h4>🔧 硬件层 (Hardware Layer)</h4>
                            <p>风扇阵列硬件，支持PWM调速控制、RPM转速检测、超时保护机制。默认超时时间30ms，波特率460800，支持JPL和标准两种硬件配置。</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Setup Section -->
        <section id="setup" class="section bg-light">
            <div class="container">
                <h2>快速开始</h2>
                <div class="setup-steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h3>环境准备</h3>
                            <pre><code class="language-bash"># 安装Mbed CLI
pip install mbed-cli

# 安装Python依赖(仅需numpy)
pip install numpy

# 下载ARM GCC工具链
# 从ARM官网下载适合您系统的版本</code></pre>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h3>获取项目源码</h3>
                            <pre><code class="language-bash">git clone https://github.com/chendashuai/fan-club-master_trae.git
cd fan-club-master_trae

# 如果有子模块，初始化它们
git submodule update --init --recursive</code></pre>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h3>编译从设备固件</h3>
                            <pre><code class="language-bash">cd slave

# 设置Mbed目标和工具链
mbed target NUCLEO_F429ZI
mbed toolchain GCC_ARM

# 编译项目
mbed compile</code></pre>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h3>烧录和配置硬件</h3>
                            <pre><code class="language-bash"># 烧录固件到开发板
cp BUILD/NUCLEO_F429ZI/GCC_ARM/slave.bin /media/NUCLEO/

# 或使用预编译的二进制文件
# 解压master/FC_MkIV_binaries.zip
# 烧录其中的Slave.bin文件</code></pre>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">5</div>
                        <div class="step-content">
                            <h3>启动主控系统</h3>
                            <pre><code class="language-bash">cd ../master

# 启动主控程序(默认SEVENSQ配置)
python3 main.py

# 或指定特定配置文件
python3 main.py MODULE

# 在Network标签页设置广播IP为路由器网关IP
# 例如: 192.168.0.255</code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- API Documentation -->
        <section id="api" class="section">
            <div class="container">
                <h2>API文档</h2>
                <div class="api-content">
                    <div class="api-section">
                        <h3>网络通信协议</h3>
                        <div class="api-method">
                            <h4>UDP 端口 65000 (广播)</h4>
                            <p>设备发现和连接建立，使用密码"CT"进行身份验证</p>
                        </div>
                        <div class="api-method">
                            <h4>UDP 端口 60000 (MISO)</h4>
                            <p>从设备到主控的数据上传通道</p>
                        </div>
                        <div class="api-method">
                            <h4>UDP 端口 60001 (MOSI)</h4>
                            <p>主控到从设备的命令下发通道</p>
                        </div>
                    </div>
                    <div class="api-section">
                        <h3>风扇控制命令</h3>
                        <div class="api-method">
                            <h4>SET_DUTY {fan_id} {duty}</h4>
                            <p>设置指定风扇的PWM占空比(0-100%)</p>
                        </div>
                        <div class="api-method">
                            <h4>GET_RPM {fan_id}</h4>
                            <p>获取指定风扇的实时转速(RPM)</p>
                        </div>
                        <div class="api-method">
                            <h4>GET_STATUS</h4>
                            <p>获取所有风扇的运行状态和系统信息</p>
                        </div>
                    </div>
                    <div class="api-section">
                        <h3>系统配置接口</h3>
                        <div class="api-method">
                            <h4>配置文件切换</h4>
                            <p>支持SEVENSQ、MODULE、DEV1-3、BOX、BASE等预设配置</p>
                        </div>
                        <div class="api-method">
                            <h4>串口调试</h4>
                            <p>波特率460800，用于系统状态监控和故障诊断</p>
                        </div>
                        <div class="api-method">
                            <h4>LED状态指示</h4>
                            <p>红灯/绿灯显示连接状态，支持闪烁模式</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Download Section -->
        <section id="download" class="section bg-light">
            <div class="container">
                <h2>下载</h2>
                <div class="download-grid">
                    <div class="download-item">
                        <h3>🔧 预编译固件</h3>
                        <p>适用于NUCLEO F429ZI/F439ZI的预编译二进制文件</p>
                        <div class="download-buttons">
                            <a href="master/FC_MkIV_binaries.zip" class="btn btn-outline">Slave.bin</a>
                            <a href="#" class="btn btn-outline">配置说明</a>
                        </div>
                    </div>
                    <div class="download-item">
                        <h3>🖥️ Python主控程序</h3>
                        <p>基于Tkinter的跨平台GUI控制程序</p>
                        <div class="download-buttons">
                            <a href="master/main.py" class="btn btn-outline">main.py</a>
                            <a href="master/fc/" class="btn btn-outline">FC模块</a>
                            <a href="master/fc/builtin/profiles.py" class="btn btn-outline">配置文件</a>
                        </div>
                    </div>
                    <div class="download-item">
                        <h3>📚 开发文档</h3>
                        <p>完整的开发文档和API参考</p>
                        <div class="download-buttons">
                            <a href="README.md" class="btn btn-outline">README</a>
                            <a href="docs/" class="btn btn-outline">技术文档</a>
                            <a href="https://github.com/chendashuai/fan-club-master_trae" class="btn btn-outline">GitHub仓库</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Fan Club MkIV</h3>
                    <p>智能风扇控制系统</p>
                </div>
                <div class="footer-section">
                    <h3>链接</h3>
                    <ul>
                        <li><a href="#overview">项目概述</a></li>
                        <li><a href="#setup">快速开始</a></li>
                        <li><a href="#api">API文档</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>支持</h3>
                    <ul>
                        <li><a href="https://github.com/your-username/fan-club-master/issues">问题反馈</a></li>
                        <li><a href="mailto:your-email@example.com">联系我们</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Fan Club MkIV - 加州理工学院 GALCIT 实验室. 开源项目，遵循相应开源协议。</p>
            </div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="script.js"></script>
</body>
</html>